#!/usr/bin/env bash
set -euo pipefail

if [ "$#" -ne 2 ]; then
  echo "Usage: $0 <URL> <output-filename.mkv>"
  exit 1
fi

URL="$1"
OUTFILE="$2"

# Adjust this to your host download folder
HOST_DOWNLOADS_DIR="/storage/downloads/streams"

# Ensure the host directory exists
#mkdir -p "$HOST_DOWNLOADS_DIR"

# Build the image if needed
docker build -t chronicle-recorder .

# Run the container and map the downloads folder
docker run --rm \
  -v "$HOST_DOWNLOADS_DIR":/downloads \
  chronicle-recorder \
  "$URL" \
  "$OUTFILE"
